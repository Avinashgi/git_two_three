utility functions for version 1
utility functions for version 2
version 3
